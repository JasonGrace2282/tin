{% extends "base.html" %}

{% block main %}

<div class="header">
  <h2 class="left">Courses</h2>
  {% if request.user.is_teacher or request.user.is_superuser %}
  <a class="right tin-btn" href="{% url 'courses:create' %}">New course</a>
  {% endif %}
</div>
<ul id="course-list">
{% for course in courses %}
  <li>
    <div class="left">
      <a href="{% url 'courses:show' course.id %}">{{ course.name }}</a>
      {% if course in courses_with_unsubmitted_assignments %}
        <br>
        <span class="italic">Unsubmitted assignments</span>
      {% endif %}
    </div>
    <div class="right">
      Teacher: <a href="mailto:{{ course.teacher.email }}">{{ course.teacher.full_name }}</a><br>
      {{ course.students.count }} student{{ course.students.count | pluralize }}
    </div>
  </li>
{% empty %}
  <li>
    <div class="left">
      <p>No courses to show</p>
    </div>
  </li>
{% endfor %}
</ul>

{% if request.user.is_student %}
  <h2>Unsubmitted Assignments</h2>
  <ul id="course-list">
  {% for assignment in unsubmitted_assignments %}
    <li>
      <div class="left">
        <a href="{% url "assignments:show" assignment.id %}">{{ assignment.name }} &mdash; {{ assignment.course.name }}</a>{% if assignment.hidden %}<i> (Hidden)</i>{% endif %}
      </div>
      <a href="{% url "assignments:submit" assignment.id %}" class="right tin-btn">Submit</a>
    </li>
  {% empty %}
    <li>
      <div class="left">
        You're all caught up!
      </div>
    </li>
  {% endfor %}
  </ul>
  <h2>Assignments due in the next week</h2>
  <ul id="course-list">
  {% for assignment in due_soon_assignments %}
    <li>
      <div class="left">
        <a href="{% url "assignments:show" assignment.id %}">{{ assignment.name }} &mdash; {{ assignment.course.name }}</a>{% if assignment.hidden %}<i> (Hidden)</i>{% endif %}
      </div>
      <a href="{% url "assignments:submit" assignment.id %}" class="right tin-btn">Submit</a>
    </li>
  {% empty %}
    <li>
      <div class="left">
        Nothing's due in the next week.
      </div>
    </li>
  {% endfor %}
  </ul>
  <h2>All assignments</h2>
  <ul id="course-list">
  {% for assignment in all_assignments %}
    <li>
      <div class="left">
        <a href="{% url "assignments:show" assignment.id %}">{{ assignment.name }} &mdash; {{ assignment.course.name }}</a>{% if assignment.hidden %}<i> (Hidden)</i>{% endif %}
      </div>
      <a href="{% url "assignments:submit" assignment.id %}" class="right tin-btn">Submit</a>
    </li>
  {% empty %}
    <li>
      <div class="left">
        No assignments.
      </div>
    </li>
  {% endfor %}
  </ul>
{% else %}
  <h4><a href="{% url 'docs:index' %}" class="tin-btn fa fa-book"> Tin documentation</a></h4>
{% endif %}

{% if request.user.is_superuser %}
  <h2>Administration</h2>
  <p><a href="/admin">Django Administrative Interface</a></p>

  <form method="post" action="{% url 'submissions:set_aborted_complete' %}">
    {% csrf_token %}
    <input type="submit" value="Mark all aborted submissions as complete">
  </form>

  <form method="post" action="{% url 'submissions:set_past_timeout_complete' %}">
    {% csrf_token %}
    <input type="submit" value="Mark all submissions that have passed the grader timeout as complete">
  </form>

{% endif %}

{% endblock %}

