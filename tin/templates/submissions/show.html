{% extends "base.html" %}
{% load staticfiles %}


{% block title %}
Turn-In: {{ course.name }}: {{ assignment.name }}:
{% if not request.user.is_student %}{{ student.username }}:{% endif %}
Submission #{{ submission_number }}
{% endblock %}

{% block head %}
  <script src="{% static 'js/incomplete.js' %}"></script>
{% endblock %}

{% block main %}
{% if request.user.is_student %}
<h2>{{ assignment.name }}: Submission #{{ submission_number }}</h2>
<p>{{ assignment.description }}</h1>

<table id="submission-info">
  <tr>
    <th>Due:</th>
    <td>{{ assignment.due }}</td>
  </tr>
  <tr>
    <th>Submitted:</th>
    <td>{{ submission.date_submitted }}</td>
  </tr>
  <tr>
    <th>On time?</th>
    <td>
      {% if submission.is_on_time %}Yes{% else %}No{% endif %}
    </td>
  </tr>
  <tr>
    <th>Completed?</th>
    <td class="{% if not submission.complete %}incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="complete">
      {% if submission.complete %}Yes{% else %}No{% endif %}
    </td>
  </tr>
  <tr>
    <th>Grade:</th>
    <td id="grade" class="{% if not submission.complete %}incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="formatted_grade">
      {% if not submission.has_been_graded %}
        <span class="result-not-graded italic">Not graded</span>
      {% else %}
        {{ submission.formatted_grade }}
      {% endif %}
    </td>
  </tr>
</table>
{% else %}
<h2>{{ assignment.name }}: {{ submission.student.full_name }} ({{ submission.student.username }}): Submission #{{ submission_number }}</h2>
<p>{{ assignment.description }}</h1>

<table id="submission-info">
  <tr>
    <th>Due:</th>
    <td>{{ assignment.due }}</td>
  </tr>
  <tr>
    <th>Submitted:</th>
    <td>{{ submission.date_submitted }}</td>
  </tr>
  <tr>
    <th>On time?</th>
    <td>
      {% if submission.is_on_time %}Yes{% else %}No{% endif %}
    </td>
  </tr>
  <tr>
    <th>Completed?</th>
    <td class="{% if not submission.complete %}incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="complete">
      {% if submission.complete %}Yes{% else %}No{% endif %}
    </td>
  </tr>
  <tr>
    <th>Grade:</th>
    <td id="grade" class="{% if not submission.complete %}incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="formatted_grade">
      {% if not submission.has_been_graded %}
        <span class="result-not-graded italic">Not graded</span>
      {% else %}
        {{ submission.formatted_grade }}
      {% endif %}
    </td>
  </tr>
</table>
{% endif%}

<h3 style="border-top:1px solid lightgray;padding-top:15px;">Grader output</h3>
<div id="grader-output" class="code-result{% if not submission.complete %} incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="grader_output">
  <div class="result">
    <code><pre>{{ submission.grader_output }}</pre></code>
  </div>
  {% if not submission.complete %}
    <div class="continuous-progress"></div>
  {% endif %}
</div>

{% if not request.user.is_student %}
  <h3 style="border-top:1px solid lightgray;padding-top:15px;">Grader errors</h3>
  <div id="grader-errors" class="code-result{% if not submission.complete %} incomplete{% endif %}" data-endpoint="{% url 'submissions:show_json' submission.id %}" data-endpoint-key="grader_errors">
    <div class="result">
      <code><pre>{{ submission.grader_errors }}</pre></code>
    </div>
    {% if not submission.complete %}
      <div class="continuous-progress"></div>
    {% endif %}
  </div>
{% endif %}

<h3 style="border-top:1px solid lightgray;padding-top:15px;">Submission</h3>
<pre><code>{{ submission_text }}</code></pre>

{% endblock %}

